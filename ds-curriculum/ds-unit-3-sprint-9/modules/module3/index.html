<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Module 3: Containers and Reproducible Builds</title>
    <link rel="stylesheet" href="../../../css/style.css">
</head>

<body>
    <header>
        <nav>
            <div class="logo">Data Science Unit 3</div>
            <ul>
                <li><a href="../../index.html">Home</a></li>
                <li class="dropdown">
                    <a href="#" class="active">Modules</a>
                    <div class="dropdown-content">
                        <a href="../module1/index.html">Module 1: Python Modules Packages Environments</a>
                        <a href="../module2/index.html">Module 2: OOP-Code-Style-Reviews</a>
                        <a href="../module3/index.html" class="active">Module 3: Containers and Reproducible Builds</a>
                        <a href="../module4/index.html">Module 4: Software Testing Documentation Licensing</a>
                    </div>
                </li>
                <li><a href="../../code-alongs/index.html">Code-Alongs</a></li>
                <li><a href="../../sprint-challenge/index.html">Sprint Challenge</a></li>
            </ul>
        </nav>
    </header>

    <main class="container">
        <h1>Module 3: Containers and Reproducible Builds</h1>

        <section class="content-box">
            <h2>Module Overview</h2>
            <p>"Works on my machine" is a common state of code developed by people lacking in software engineering
                background. It must be reproducible for code (and science) to work.</p>
            <p>We've already learned about pipenv as a Python packaging tool, which goes a long way towards giving
                reproducible builds - but for even greater reproducibility (and deployability), containers are the tool
                of choice. A container is a minimal virtual operating system, complete with all the software needed to
                run the desired application. Because they pack everything together, they are identical to run regardless
                of host.</p>
            <p>Docker is a common standard and tool for containers, and we will use it to build and run Linux containers
                with Python code.</p>
        </section>

        <section class="content-box">
            <h2>Learning Objectives</h2>
            <ul>
                <li>Launch Docker containers and access/execute programs on them</li>
                <li>Create and customize a Dockerfile to build a basic custom container</li>
            </ul>
        </section>

        <section class="content-box">
            <h2>Objective 01 - launch Docker containers and execute programs on them</h2>
            <h3>Overview</h3>
            <p>The purpose of containers is to run code, reliably and reproducibly. Even something as simple as “Hello
                World!”, achieved identically and independently of platform, is a remarkable and powerful thing.</p>
            <p>What is a container? Just something that holds other things - in the context of computation, a system
                that holds programs. The difference between a container and the computer you’re using right now is that
                a container is abstracted and virtualized - it is independent of the hardware and (external) operating
                system it runs on.</p>
            <h3>Follow Along</h3>
            <p>Once installed, Docker “Hello World!” is as simple as:</p>
            <pre><code>docker run hello-world</code></pre>
            <p>Try it out! You should see something like:</p>
            <pre><code>docker run hello-world

Unable to find image 'hello-world:latest' locally
latest: Pulling from library/hello-world
ca4f61b1923c: Pull complete
Digest: sha256:ca0eeb6fb05351dfc8759c20733c91def84cb8007aa89a5bf606bc8b315b9fc7
Status: Downloaded newer image for hello-world:latest

Hello from Docker!
This message shows that your installation appears to be working correctly.
...</code></pre>
            <p>But what’s really happening?</p>
            <ul>
                <li>Docker is looking for a container named hello-world</li>
                <li>It doesn’t find it!</li>
                <li>But not to worry - it looks for and pulls it from the official Docker Cloud</li>
                <li>After some network and hash/checksumming (basically “making sure it gets the right thing”)…</li>
                <li>The image is downloaded and executed!</li>
                <li>The result - well, it prints “Hello from Docker!” This is hello-world, after all.</li>
            </ul>
            <p>But the somewhat subtle and crazy thing here is that this message is the single purpose of an entire
                operating system, contained and reproduced exactly (byte-for-byte) whenever and wherever you run it.</p>
            <p>So, while “Hello World!” may not exactly pay the bills, the general idea that it demonstrates is clearly
                powerful. And it’s up to us to use that power to make our code reliable and reproducible.</p>
            <h3>Challenge</h3>
            <p>Read up on Docker documentation, and execute something on a Docker container beyond “Hello World!”</p>
            <h3>Additional Resources</h3>
            <ul>
                <li>An introduction to Docker (brownbag presentation)Links to an external site.</li>
                <li>Hands-on Machine Learning in DockerLinks to an external site.</li>
            </ul>
        </section>

        <section class="content-box">
            <h2>Objective 02 - create and customize a Dockerfile to build a basic custom container</h2>
            <h3>Overview</h3>
            <p>Running containers that other people make is useful - there are a lot of premade containers out there.
                But the real power of Docker is in customizing your own container, and running your own reproducible
                code in a variety of environments.</p>
            <p>To customize Docker, you must write a Dockerfile - a text file “recipe” that specifies the
                container/Linux distribution you are basing your container on, and then add additional environment setup
                steps.</p>
            <h3>Follow Along</h3>
            <p>Example MVP Dockerfile for Python:</p>
            <pre><code>FROM debian

### So logging/io works reliably w/Docker
ENV PYTHONUNBUFFERED=1
### UTF Python issue for Click package (pipenv dependency)
ENV LC_ALL=C.UTF-8
ENV LANG=C.UTF-8
### Need to explicitly set this so `pipenv shell` works
ENV SHELL=/bin/bash

### Basic Python dev dependencies
RUN apt-get update && \
  apt-get upgrade -y && \
  apt-get install python3-pip curl -y && \
  pip3 install pipenv
</code></pre>
            <ol>
                <li>Put the above in a Dockerfile</li>
                <li><code>docker build . -t python</code></li>
                <li>Wait (may take awhile, especially if it’s your first container)</li>
                <li><code>docker run -it python /bin/bash</code></li>
            </ol>
            <p>You’re now in a reproducible environment with pipenv! When you’re done, exit - but note that if you run
                it again it will actually be a new copy of the container, i.e. you don’t see what you did in the earlier
                version of the container.</p>
            <p>If you want to reuse a single container, read up on docker restart and docker attach - but the idea of a
                container always being clean is actually quite powerful, as that is where reproducible builds come from.
                With a more elaborate Dockerfile (that specifies an actual package to install and run), you can have a
                contained and reproducible app that you know runs the same everywhere.</p>
            <h3>Challenge</h3>
            <p>Build on the Dockerfile above - add to the RUN command to install specific useful packages and execute
                them. You may have to read up on docker run, in particular the -p argument to expose a port from the
                Docker container to localhost - this lets you run a Jupyter notebook server inside Docker and access it
                from your external operating system.</p>
            <p>To see how deep the rabbit hole goes, check out Docker Compose<a href="#" target="_blank"
                    rel="noopener noreferrer">Links to an external site.</a>.</p>
            <h3>Additional Resources</h3>
            <ul>
                <li>Docker Classroom for Dockerfiles<a href="#" target="_blank" rel="noopener noreferrer">Links to an
                        external site.</a>.</li>
                <li>VMs versus Containers<a href="#" target="_blank" rel="noopener noreferrer">Links to an external
                        site.</a>.</li>
                <li>Kubernetes<a href="#" target="_blank" rel="noopener noreferrer">Links to an external site.</a>.</li>
            </ul>
        </section>

        <section class="content-box">
            <h2>Guided Project</h2>

            <p>In this guided project, we'll learn how to create Docker containers for reproducible Python environments.
                Open <strong>guided-project.md</strong> in the GitHub repository below to follow along with the guided
                project.</p>

            <div class="resource-links">
                <a href="https://github.com/bloominstituteoftechnology/DS-Unit-3-Sprint-1-Software-Engineering/tree/main/module3-containers-and-reproducible-builds"
                    class="resource-link" target="_blank" rel="noopener noreferrer">GitHub Repo</a>
                <a href="https://hub.docker.com/signup" class="resource-link" target="_blank"
                    rel="noopener noreferrer">Docker Hub
                    Signup Page</a>
                <a href="https://labs.play-with-docker.com/" class="resource-link" target="_blank"
                    rel="noopener noreferrer">Docker
                    Sandbox Applet</a>
            </div>

            <div class="video-container">
                <iframe src="https://fast.wistia.net/embed/iframe/q0yjf835vu" allowtransparency="true" frameborder="0"
                    scrolling="no" class="wistia_embed" name="wistia_embed"
                    title="Module 3 Guided Project: Containers and Docker" allowfullscreen mozallowfullscreen
                    webkitallowfullscreen oallowfullscreen msallowfullscreen></iframe>
            </div>
        </section>

        <section class="content-box">
            <h2>Module Assignment</h2>
            <p>For this assignment, you'll create Docker containers and Dockerfiles to demonstrate your understanding of
                containerization and reproducible builds.</p>

            <div class="resource-links">
                <a href="https://github.com/bloominstituteoftechnology/DS-Unit-3-Sprint-1-Software-Engineering/blob/main/module3-containers-and-reproducible-builds/assignment.md"
                    class="resource-link" target="_blank" rel="noopener noreferrer">Module 3 Assignment</a>
            </div>

            <h3>Solution Video</h3>
            <div class="video-container">
                <iframe src="https://fast.wistia.net/embed/iframe/scl7srbizc" allowtransparency="true" frameborder="0"
                    scrolling="no" class="wistia_embed" name="wistia_embed" title="Module 3 Assignment Solution Video"
                    allowfullscreen mozallowfullscreen webkitallowfullscreen oallowfullscreen
                    msallowfullscreen></iframe>
            </div>
        </section>

        <section class="content-box">
            <h2>Additional Resources</h2>
            <h3>Docker Fundamentals</h3>
            <ul>
                <li><a href="https://www.youtube.com/watch?v=kQbDnDsO8MQ&feature=youtu.be" target="_blank"
                        rel="noopener noreferrer">An introduction to Docker (brownbag presentation)</a></li>
                <li><a href="https://training.play-with-docker.com/ops-s1-images/" target="_blank"
                        rel="noopener noreferrer">Docker
                        Classroom for Dockerfiles</a></li>
                <li><a href="https://www.backblaze.com/blog/vm-vs-containers/" target="_blank"
                        rel="noopener noreferrer">VMs versus
                        Containers</a></li>
            </ul>

            <h3>Advanced Tools</h3>
            <ul>
                <li><a href="https://docs.docker.com/compose/" target="_blank" rel="noopener noreferrer">Docker
                        Compose</a></li>
                <li><a href="https://kubernetes.io/" target="_blank" rel="noopener noreferrer">Kubernetes</a></li>
            </ul>

            <h3>Machine Learning with Docker</h3>
            <ul>
                <li><a href="https://github.com/ageron/handson-ml/tree/master/docker" target="_blank"
                        rel="noopener noreferrer">Hands-on Machine Learning in Docker</a></li>
            </ul>
        </section>
    </main>
</body>

</html>